{
    "MOVEit DLL Compilation": {
        "query": ["SrcProcName = \"w3wp.exe\" AND TgtProcName = \"csc.exe\" AND SrcProcCmdLine Contains Anycase \"moveitdmz pool\""]
    },
    "Anomalous Library Loads for w3wp.exe": {
        "query": ["IndicatorName = \"LoadUnreleatedLibrary\" AND IndicatorMetadata Contains \"w3wp.exe\" AND SrcProcName StartsWith \"DMZ\""]
    },
    "ASPX Created in MoveIT Web Directory": {
        "query": ["EventType In (\"File Creation\", \"File Modification\") AND SrcProcName Contains Anycase \"w3wp.exe\" And TgtFilePath RegExp \"\\\\moveit[^\\\\]+\" And TgtFilePath Contains Anycase \"wwwroot\" And TgtFileExtension = \"aspx\""]
    },
    "Suspicous File Creation in MoveIT Web Directory": {
        "query": ["TgtFilePath RegExp \"\\\\MOVEit Transfer\\\\wwwroot\\\\[^\\\\]{1,40}\\.\" and (TgtFilePath RegExp \"(zip|rar|7z|exe|ps1|bat|cmdline|jsf|aspx|php|dll)$\" or TgtFileSize > \"100\")"]
    },
    "Compiled DLL or Known Exploited ASPX File Created": {
        "query": ["(EventType = \"File Creation\" AND TgtFilePath Contains Anycase \"App_Web_\" AND TgtFilePath EndsWithCIS \".dll\" and tgtfilepath ContainsCIS \"\\Temporary ASP.NET Files\") or TgtFilePath In Contains Anycase (\"human2.aspx\" , \"machine2.aspx\")"]
    }
}